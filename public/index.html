<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>purple valley</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Google+Sans+Flex:wght@100..900&display=swap"
    rel="stylesheet">
  <link
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    rel="stylesheet">
  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" sizes="180x180" href="/mindcomplete-favicon.png">
  <link rel="icon" type="image/png" sizes="180x180" href="/mindcomplete-favicon.png">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <header class="header">
    <div class="header-left">
      <button class="icon-btn" id="menu-btn" aria-label="Menu">
        <span class="material-symbols-outlined">dehaze</span>
      </button>
      <span class="logo">purple valley</span>
    </div>
    <div class="header-right">
      <button class="icon-btn" id="settings-btn" aria-label="Settings">
        <span class="material-symbols-outlined">edit</span>
      </button>
    </div>
  </header>

  <!-- Select confirm button (floating) -->
  <button class="select-confirm-btn" aria-label="Confirm selection">
    <span class="material-symbols-outlined">check</span>
  </button>

  <!-- Gradient overlay to fade text under header -->
  <div class="header-gradient-overlay"></div>

  <!-- Burger Menu Overlay -->
  <div class="menu-overlay right-menu-overlay">
    <div class="menu-content">
      <button class="menu-item context-menu-btn">
        <span class="material-symbols-outlined">apps</span>
        <span class="menu-label">Manage context</span>
      </button>
      <button class="menu-item create-image-btn">
        <span class="material-symbols-outlined">image</span>
        <span class="menu-label">Create image</span>
      </button>
      <button class="menu-item select-menu-btn">
        <span class="material-symbols-outlined">text_select_end</span>
        <span class="menu-label">Select part</span>
      </button>
      <button class="menu-item share-menu-btn">
        <span class="material-symbols-outlined">ios_share</span>
        <span class="menu-label">Share</span>
      </button>
      <button class="menu-item clear-menu-btn">
        <span class="material-symbols-outlined">ink_eraser</span>
        <span class="menu-label">Clear</span>
      </button>
      <button class="menu-item save-valley-btn">
        <span class="material-symbols-outlined">save</span>
        <span class="menu-label">Save valley</span>
      </button>
    </div>
  </div>

  <!-- Left Menu Overlay -->
  <div class="menu-overlay left-menu-overlay">
    <div class="menu-content left-aligned">
      <button class="menu-item theme-toggle-btn">
        <span class="material-symbols-outlined">dark_mode</span>
        <span class="menu-label">Dark mode</span>
      </button>
      <button class="menu-item valleys-menu-btn">
        <span class="material-symbols-outlined">landscape</span>
        <span class="menu-label">Valleys</span>
      </button>
      <button class="menu-item profile-menu-btn">
        <span class="material-symbols-outlined">person</span>
        <span class="menu-label">Sign In</span>
      </button>
      <button class="menu-item about-menu-btn">
        <span class="material-symbols-outlined">info</span>
        <span class="menu-label">About</span>
      </button>
    </div>
  </div>

  <div class="container">
    <div class="editor-wrapper">
      <!-- Editable layer with inline predictions -->
      <div class="editor" contenteditable="true" data-placeholder="What's on your mind" spellcheck="false"></div>
    </div>
  </div>

  <!-- About Modal -->
  <!-- About Modal -->
  <div class="modal" id="about-modal">
    <div class="modal-content context-modal-content">
      <!-- Modal Header -->
      <div class="context-modal-header">
        <div class="header-spacer"></div>
        <span class="context-modal-title">About</span>
        <button class="context-modal-close" id="about-modal-close">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>

      <!-- Modal Body -->
      <div class="context-modal-body">
        <div class="context-section">
          <div class="section-header">
            <h3 class="section-title">Purple Valley</h3>
            <p class="section-description">
              Purple Valley helps you expand your ideas by completing your thoughts with AI. Start typing, pause, and
              watch your ideas flow.
              <br><br>
              Click in the middle to accept part. Tab to accept full suggestion.
            </p>
          </div>

          <div class="modal-donate">
            <p class="section-description" style="margin-bottom: 16px;">Enjoying purple valley?</p>
            <a href="https://buymeacoffee.com/yourusername" target="_blank" rel="noopener noreferrer"
              class="donate-btn">
              <span>â˜•</span> Buy me a coffee
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Context Upload Modal -->
  <div class="modal" id="context-modal">
    <div class="modal-content context-modal-content">
      <!-- Modal Header -->
      <div class="context-modal-header">
        <div class="header-spacer"></div>
        <span class="context-modal-title">Manage context</span>
        <button class="context-modal-close" id="context-modal-close">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>

      <!-- Modal Body -->
      <div class="context-modal-body">
        <!-- Section 1: Add Rules -->
        <div class="context-section">
          <div class="section-header">
            <h3 class="section-title">Add rules</h3>
            <p class="section-description">This is a field to add context to make magic complete understand you faster.
            </p>
          </div>
          <textarea id="context-textarea" placeholder="Write or paste your rules"></textarea>
          <div class="section-buttons">
            <button class="btn-white" id="save-rules-btn">Save rules</button>
            <button class="btn-secondary" id="clear-rules-btn">Clear rules</button>
            <span class="rules-status" id="rules-status"></span>
          </div>
        </div>

        <!-- Section 2: Upload Files -->
        <div class="context-section">
          <div class="section-header">
            <h3 class="section-title">Upload files</h3>
            <p class="section-description">Upload files to help the AI understand what you're writing about.</p>
          </div>
          <div class="context-files" id="context-files"></div>
          <input type="file" id="file-input" multiple accept=".pdf,.txt,.md,text/plain,text/markdown,application/pdf"
            class="visually-hidden">
          <div class="context-status" id="context-status"></div>
          <div class="section-buttons">
            <button class="btn-white" id="upload-btn">
              <span class="material-symbols-outlined">attach_file</span>
              Upload files
            </button>
            <button class="btn-secondary" id="remove-files-btn">Remove files</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Image Guidance Modal -->
  <div class="modal" id="image-guidance-modal">
    <div class="modal-content image-guidance-modal-content">
      <div class="image-guidance-header">
        <div class="header-spacer"></div>
        <span class="image-guidance-title">Add image context</span>
        <button class="image-guidance-close" id="image-guidance-close">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
      <div class="image-guidance-body">
        <textarea id="image-guidance-textarea" placeholder="Optional"></textarea>
        <div class="image-guidance-buttons">
          <button class="btn-secondary" id="skip-guidance-btn">Skip</button>
          <button class="btn-white" id="apply-guidance-btn">Add context</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Valleys Modal -->
  <div class="modal" id="valleys-modal">
    <div class="modal-content context-modal-content">
      <div class="context-modal-header">
        <div class="header-spacer"></div>
        <span class="context-modal-title">Valleys</span>
        <button class="context-modal-close" id="valleys-modal-close">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
      <div class="context-modal-body">
        <div class="context-section">
          <div class="section-header">
            <p class="section-description">Your saved valleys</p>
          </div>
          <div class="valleys-list" id="valleys-list"></div>
          <div class="valleys-empty" id="valleys-empty">
            <p class="section-description">No valleys saved yet</p>
          </div>
          <div class="section-buttons">
            <button class="btn-white" id="new-valley-btn">
              <span class="material-symbols-outlined">add</span>
              New valley
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Auth Modal -->
  <div class="modal" id="auth-modal">
    <div class="modal-content context-modal-content">
      <div class="context-modal-header">
        <div class="header-spacer"></div>
        <span class="context-modal-title" id="auth-modal-title">Sign In</span>
        <button class="context-modal-close" id="auth-modal-close">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
      <div class="context-modal-body">
        <div class="context-section" id="auth-form-section">
          <!-- Auth Tabs -->
          <div class="auth-tabs">
            <button class="auth-tab active" data-tab="signin">Sign In</button>
            <button class="auth-tab" data-tab="signup">Sign Up</button>
          </div>

          <!-- Email Input -->
          <input type="email" id="auth-email" class="auth-input" placeholder="Email">

          <!-- Password Input -->
          <input type="password" id="auth-password" class="auth-input" placeholder="Password">

          <!-- Error Message -->
          <div class="auth-error" id="auth-error"></div>

          <!-- Submit Button -->
          <div class="section-buttons">
            <button class="btn-white" id="auth-submit-btn">Sign In</button>
          </div>

          <!-- Divider -->
          <div class="auth-divider">
            <span>or</span>
          </div>

          <!-- Social Login -->
          <button class="btn-social" id="google-signin-btn">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M17.64 9.205c0-.639-.057-1.252-.164-1.841H9v3.481h4.844a4.14 4.14 0 0 1-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615Z" fill="#4285F4"/>
              <path d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332A8.997 8.997 0 0 0 9 18Z" fill="#34A853"/>
              <path d="M3.964 10.71A5.41 5.41 0 0 1 3.682 9c0-.593.102-1.17.282-1.71V4.958H.957A8.996 8.996 0 0 0 0 9c0 1.452.348 2.827.957 4.042l3.007-2.332Z" fill="#FBBC05"/>
              <path d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0A8.997 8.997 0 0 0 .957 4.958L3.964 7.29C4.672 5.163 6.656 3.58 9 3.58Z" fill="#EA4335"/>
            </svg>
            Continue with Google
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Account Modal -->
  <div class="modal" id="account-modal">
    <div class="modal-content context-modal-content">
      <div class="context-modal-header">
        <div class="header-spacer"></div>
        <span class="context-modal-title">Account</span>
        <button class="context-modal-close" id="account-modal-close">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
      <div class="context-modal-body">
        <div class="context-section">
          <div class="account-email" id="account-email"></div>
          <div class="section-buttons account-buttons">
            <button class="btn-white" id="signout-btn">Sign Out</button>
            <button class="btn-danger" id="delete-account-btn">Delete Account</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="supabaseClient.js"></script>
  <script src="app.js"></script>
</body>

</html>