<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>purple valley</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Google+Sans+Flex:wght@100..900&family=Inter:wght@100..900&family=Literata:ital,opsz,wght@0,7..72,200..900;1,7..72,200..900&display=swap"
    rel="stylesheet">
  <link
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    rel="stylesheet">
  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" sizes="180x180" href="/mindcomplete-favicon.png">
  <link rel="icon" type="image/png" sizes="180x180" href="/mindcomplete-favicon.png">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <header class="header">
    <div class="header-left">
      <button class="icon-btn" id="menu-btn" aria-label="Menu">
        <span class="material-symbols-outlined">dehaze</span>
      </button>
      <span class="logo">purple valley</span>
    </div>
    <div class="header-right">
      <button class="icon-btn" id="settings-btn" aria-label="Settings">
        <span class="material-symbols-outlined">edit</span>
      </button>
    </div>
  </header>

  <!-- Select confirm button (floating) -->
  <button class="select-confirm-btn" aria-label="Confirm selection">
    <span class="material-symbols-outlined">check</span>
  </button>

  <!-- Gradient overlay to fade text under header -->
  <div class="header-gradient-overlay"></div>

  <!-- Burger Menu Overlay -->
  <div class="menu-overlay right-menu-overlay">
    <div class="menu-content">
      <button class="menu-item files-menu-btn">
        <span class="material-symbols-outlined">attach_file</span>
        <span class="menu-label">Upload files</span>
      </button>
      <button class="menu-item rules-menu-btn">
        <span class="material-symbols-outlined">edit_note</span>
        <span class="menu-label">Add rules</span>
      </button>
      <button class="menu-item create-image-btn">
        <span class="material-symbols-outlined">image</span>
        <span class="menu-label">Create image</span>
      </button>
      <button class="menu-item select-menu-btn">
        <span class="material-symbols-outlined">text_select_end</span>
        <span class="menu-label">Select part</span>
      </button>
      <button class="menu-item share-menu-btn">
        <span class="material-symbols-outlined">ios_share</span>
        <span class="menu-label">Share</span>
      </button>
      <button class="menu-item clear-menu-btn">
        <span class="material-symbols-outlined">ink_eraser</span>
        <span class="menu-label">Clear</span>
      </button>
      <button class="menu-item save-valley-btn">
        <span class="material-symbols-outlined">save</span>
        <span class="menu-label">Save valley</span>
      </button>
    </div>
  </div>

  <!-- Left Menu Overlay -->
  <div class="menu-overlay left-menu-overlay">
    <div class="menu-content left-aligned">
      <button class="menu-item theme-toggle-btn">
        <span class="material-symbols-outlined">dark_mode</span>
        <span class="menu-label">Dark mode</span>
      </button>
      <button class="menu-item valleys-menu-btn">
        <span class="material-symbols-outlined">landscape</span>
        <span class="menu-label">Valleys</span>
      </button>
      <button class="menu-item profile-menu-btn">
        <span class="material-symbols-outlined">person</span>
        <span class="menu-label">Sign In</span>
      </button>
      <button class="menu-item about-menu-btn">
        <span class="material-symbols-outlined">info</span>
        <span class="menu-label">About</span>
      </button>
    </div>
  </div>

  <div class="container">
    <div class="editor-wrapper">
      <!-- Editable layer with inline predictions -->
      <div class="editor" contenteditable="true" data-placeholder="What's on your mind" spellcheck="false"></div>
    </div>
  </div>

  <!-- About Modal -->
  <!-- About Modal -->
  <div class="modal" id="about-modal">
    <div class="modal-content context-modal-content">
      <!-- Modal Header -->
      <div class="context-modal-header">
        <div class="header-spacer"></div>
        <span class="context-modal-title">About</span>
        <button class="context-modal-close" id="about-modal-close">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>

      <!-- Modal Body -->
      <div class="context-modal-body">
        <div class="context-section">
          <div class="section-header">
            <h3 class="section-title">Purple Valley</h3>
            <p class="section-description">
              Purple Valley helps you expand your ideas by completing your thoughts with AI. Start typing, pause, and
              watch your ideas flow.
              <br><br>
              Click in the middle to accept part. Tab to accept full suggestion.
            </p>
          </div>

          <div class="modal-donate">
            <p class="section-description" style="margin-bottom: 16px;">Enjoying purple valley?</p>
            <a href="https://buymeacoffee.com/yourusername" target="_blank" rel="noopener noreferrer"
              class="donate-btn">
              <span>â˜•</span> Buy me a coffee
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Files Modal (Desktop) -->
  <div class="modal" id="files-modal">
    <div class="modal-content files-modal-content">
      <button class="files-modal-close" id="files-modal-close">
        <span class="material-symbols-outlined">close</span>
      </button>
      <div class="files-dropzone" id="files-dropzone">
        <div class="files-dropzone-icon">
          <span class="material-symbols-outlined">upload_file</span>
        </div>
        <div class="files-dropzone-title">Drop files here</div>
        <div class="files-dropzone-text">PDF, TXT, or Markdown files</div>
        <button class="btn-dark" id="browse-files-btn">Browse files</button>
      </div>
      <div class="files-list" id="files-list-section">
        <div class="files-list-header">
          <span class="files-list-title">Uploaded files</span>
          <span class="files-list-count" id="files-count">0 files</span>
        </div>
        <div id="files-list"></div>
      </div>
      <input type="file" id="file-input" multiple accept=".pdf,.txt,.md,text/plain,text/markdown,application/pdf"
        class="visually-hidden">
    </div>
  </div>

  <!-- Rules Modal (Desktop) -->
  <div class="modal" id="rules-modal">
    <div class="modal-content rules-modal-content">
      <div class="context-modal-header">
        <div class="header-spacer"></div>
        <span class="context-modal-title">Add rules</span>
        <button class="context-modal-close" id="rules-modal-close">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
      <div class="rules-modal-body">
        <p class="rules-description">Add rules to help the AI understand how to complete your thoughts.</p>
        <textarea class="rules-textarea" id="rules-textarea" placeholder="Write or paste your rules"></textarea>
        <div class="rules-buttons">
          <button class="btn-white" id="save-rules-btn">Save rules</button>
          <button class="btn-secondary" id="clear-rules-btn">Clear rules</button>
          <span class="rules-status" id="rules-status"></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Files Bottom Sheet (Mobile) -->
  <div class="bottom-sheet-overlay" id="files-bottom-sheet">
    <div class="bottom-sheet files-bottom-sheet">
      <div class="files-sheet-handle">
        <div class="bottom-sheet-handle-bar"></div>
      </div>
      <div class="bottom-sheet-body">
        <div class="files-dropzone" id="files-dropzone-mobile">
          <div class="files-dropzone-icon">
            <span class="material-symbols-outlined">upload_file</span>
          </div>
          <div class="files-dropzone-title">Drop files here</div>
          <div class="files-dropzone-text">PDF, TXT, or Markdown</div>
          <button class="btn-dark" id="browse-files-btn-mobile">Browse files</button>
        </div>
        <div class="files-list" id="files-list-section-mobile">
          <div class="files-list-header">
            <span class="files-list-title">Files</span>
            <span class="files-list-count" id="files-count-mobile">0</span>
          </div>
          <div id="files-list-mobile"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Rules Bottom Sheet (Mobile) -->
  <div class="bottom-sheet-overlay" id="rules-bottom-sheet">
    <div class="bottom-sheet">
      <div class="bottom-sheet-handle">
        <div class="bottom-sheet-handle-bar"></div>
      </div>
      <div class="bottom-sheet-header">
        <span class="bottom-sheet-title">Add rules</span>
        <button class="bottom-sheet-close" id="rules-sheet-close">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
      <div class="bottom-sheet-body">
        <div class="rules-modal-body">
          <p class="rules-description">Add rules to help the AI understand how to complete your thoughts.</p>
          <textarea class="rules-textarea" id="rules-textarea-mobile"
            placeholder="Write or paste your rules"></textarea>
          <div class="rules-buttons">
            <button class="btn-white" id="save-rules-btn-mobile">Save</button>
            <button class="btn-secondary" id="clear-rules-btn-mobile">Clear</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Image Guidance Modal -->
  <div class="modal" id="image-guidance-modal">
    <div class="modal-content image-guidance-modal-content">
      <div class="image-guidance-body">
        <div class="image-guidance-field">
          <label for="image-style-select" class="section-description">Style</label>
          <select id="image-style-select" class="image-style-select">
            <option value="anime">Anime (Hayao Miyazaki)</option>
            <option value="realistic">Realistic</option>
            <option value="handdrawing">Handdrawing</option>
            <option value="custom1">Custom 1</option>
            <option value="custom2">Custom 2</option>
          </select>
        </div>
        <div class="image-guidance-field">
          <label for="image-guidance-textarea" class="section-description">Context (Optional)</label>
          <textarea id="image-guidance-textarea" placeholder="Describe specific details..."></textarea>
        </div>
        <div class="image-guidance-buttons">
          <button class="btn-secondary" id="skip-guidance-btn">Cancel</button>
          <button class="btn-white" id="apply-guidance-btn">Create image</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Valleys Modal -->
  <div class="modal" id="valleys-modal">
    <div class="modal-content context-modal-content">
      <div class="context-modal-header">
        <div class="header-spacer"></div>
        <span class="context-modal-title">Valleys</span>
        <button class="context-modal-close" id="valleys-modal-close">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
      <div class="context-modal-body">
        <div class="context-section">
          <div class="section-header">
            <p class="section-description">Your saved valleys</p>
          </div>
          <div class="valleys-list" id="valleys-list"></div>
          <div class="valleys-empty" id="valleys-empty">
            <p class="section-description">No valleys saved yet</p>
          </div>
          <div class="section-buttons">
            <button class="btn-white" id="new-valley-btn">
              <span class="material-symbols-outlined">add</span>
              New valley
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Auth Modal -->
  <div class="modal" id="auth-modal">
    <div class="modal-content context-modal-content">
      <div class="context-modal-header">
        <div class="header-spacer"></div>
        <span class="context-modal-title" id="auth-modal-title">Sign In</span>
        <button class="context-modal-close" id="auth-modal-close">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
      <div class="context-modal-body">
        <div class="context-section" id="auth-form-section">
          <!-- Auth Tabs -->
          <div class="auth-tabs">
            <button class="auth-tab active" data-tab="signin">Sign In</button>
            <button class="auth-tab" data-tab="signup">Sign Up</button>
          </div>

          <!-- Email Input -->
          <input type="email" id="auth-email" class="auth-input" placeholder="Email">

          <!-- Password Input -->
          <input type="password" id="auth-password" class="auth-input" placeholder="Password">

          <!-- Error Message -->
          <div class="auth-error" id="auth-error"></div>

          <!-- Submit Button -->
          <div class="section-buttons">
            <button class="btn-white" id="auth-submit-btn">Sign In</button>
          </div>

        </div>
      </div>
    </div>
  </div>

  <!-- Account Modal -->
  <div class="modal" id="account-modal">
    <div class="modal-content context-modal-content">
      <div class="context-modal-header">
        <div class="header-spacer"></div>
        <span class="context-modal-title">Account</span>
        <button class="context-modal-close" id="account-modal-close">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
      <div class="context-modal-body">
        <div class="context-section">
          <div class="account-email" id="account-email"></div>
          <div class="section-buttons account-buttons">
            <button class="btn-white" id="signout-btn">Sign Out</button>
            <button class="btn-danger" id="delete-account-btn">Delete Account</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="supabaseClient.js"></script>
  <script src="app.js"></script>
</body>

</html>