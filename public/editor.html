<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mindcomplete</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Google+Sans+Flex:wght@100..900&family=Inter:wght@100..900&family=Literata:ital,opsz,wght@0,7..72,200..900;1,7..72,200..900&display=swap"
    rel="stylesheet">
  <link
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    rel="stylesheet">
  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" sizes="180x180" href="/mindcomplete-favicon.png">
  <link rel="icon" type="image/png" sizes="180x180" href="/mindcomplete-favicon.png">
  <link rel="stylesheet" href="styles.css?v=token-update-2">
</head>

<body class="sidebar-collapsed">
  <!-- Dashboard View -->
  <div id="dashboard-view" class="view-container dashboard-view">
    <header class="dashboard-header">
      <div class="header-left">
        <div class="logo-container">
          <a href="/" class="logo-link">
            <img src="mindcomplete-logo.svg" alt="Mindcomplete" class="dashboard-logo">
          </a>

        </div>
      </div>
      <div class="header-right">

        <button class="avatar-btn" id="dashboard-account-btn">
          <div class="user-avatar" id="dashboard-avatar">
            <span class="material-symbols-outlined">person</span>
          </div>
        </button>
      </div>
    </header>

    <main class="dashboard-content">

      <div class="projects-grid" id="projects-grid">
        <!-- Create New Project Card -->
        <div class="project-card create-card" id="create-project-card">
          <div class="create-icon-wrapper">
            <span class="material-symbols-outlined">add</span>
          </div>
          <span class="create-label">Create new notebook</span>
        </div>
        <!-- Projects will be injected here -->
      </div>
    </main>
  </div>

  <!-- Editor View -->
  <div id="editor-view" class="view-container editor-view" style="display: none;">
    <div class="app-shell">
      <!-- Sidebar Removed -->

      <div class="app-main" style="padding-left: 0;"> <!-- Explicitly remove padding reserved for sidebar if any -->
        <header class="header">
          <div class="header-left">
            <button class="logo-back-btn" id="back-to-dashboard-btn" aria-label="Back to Dashboard">
              <svg width="45.5" height="26" viewBox="0 0 49 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M0.000289917 22.5V3.884H3.19829L9.12629 19.146H9.23029L15.1583 3.884H18.3563V22.5H16.1723V10.67L16.2763 7.134H16.1723L10.0883 22.5H8.26829L2.18429 7.134H2.08029L2.18429 10.67V22.5H0.000289917Z"
                  fill="#D9D9D9" />
                <path d="M25.5 0V28H24.5V0H25.5Z" fill="#C3FB50" />
                <path
                  d="M41.0227 23.4122C38.2216 23.4122 35.8814 22.4637 34.0022 20.5668C32.123 18.6609 31.1834 16.2853 31.1834 13.4399C31.1834 10.5767 32.1274 8.2144 34.0155 6.35291C35.9125 4.48254 38.2482 3.54736 41.0227 3.54736C41.9712 3.54736 42.8709 3.67146 43.7219 3.91966C44.5729 4.16786 45.3441 4.518 46.0355 4.97008C46.7269 5.41329 47.2543 5.84321 47.6177 6.25983C47.99 6.67645 48.1762 6.88476 48.1762 6.88476L46.5673 8.26759C46.5673 8.26759 46.39 8.08144 46.0355 7.70914C45.6898 7.32798 45.2687 6.98227 44.7723 6.67202C44.2848 6.36177 43.7263 6.118 43.097 5.94072C42.4765 5.76343 41.7851 5.67479 41.0227 5.67479C38.8864 5.67479 37.087 6.38836 35.6244 7.81551C34.1706 9.24266 33.4438 11.113 33.4438 13.4266C33.4438 15.7313 34.1618 17.615 35.5978 19.0776C37.0427 20.5402 38.8465 21.2715 41.0094 21.2715C41.7983 21.2715 42.5341 21.1651 43.2166 20.9524C43.8992 20.7308 44.5374 20.4249 45.1313 20.0349C45.7341 19.6449 46.1906 19.2682 46.5008 18.9047C46.82 18.5413 46.9795 18.3596 46.9795 18.3596L48.6416 19.8488C48.6416 19.8488 48.4288 20.0925 48.0033 20.5801C47.5779 21.0587 46.9972 21.5285 46.2615 21.9895C45.5258 22.4416 44.7191 22.7917 43.8416 23.0399C42.9729 23.2881 42.0333 23.4122 41.0227 23.4122Z"
                  fill="#AFE04A" />
              </svg>
            </button>
            <div class="project-title-container">
              <div class="emoji-picker-container">
                <button id="project-emoji-btn" class="project-emoji-btn" aria-label="Change Icon">
                  <span id="project-emoji-display" class="project-emoji-display">üìù</span>
                </button>
                <div class="emoji-picker-dropdown" id="emoji-picker-dropdown">
                  <div class="emoji-grid" id="emoji-grid">
                    <!-- Emojis will be injected here -->
                  </div>
                </div>
              </div>
              <div class="title-wrapper">
                <span class="project-title-display" id="project-title-display">Untitled Project</span>
                <input type="text" id="project-title-input" class="project-title-input" placeholder="Untitled Project"
                  spellcheck="false">
              </div>

            </div>

          </div>
          <div class="header-right">
            <button class="btn-secondary btn-sm" id="settings-btn" aria-label="Context">
              Context
            </button>
          </div>
        </header>

        <!-- Gradient overlay to fade text under header -->
        <div class="header-gradient-overlay"></div>

        <!-- Right Side Menu Panel (Brain) -->
        <div class="side-menu-backdrop" id="side-menu-backdrop"></div>
        <div class="side-menu brain-panel" id="side-menu">
          <div class="side-menu-resizer"></div>
          <div class="brain-header">
            <h2 class="brain-title">
              Context
            </h2>
            <button class="btn-icon side-menu-close" id="side-menu-close" aria-label="Close">
              <span class="material-symbols-outlined">close</span>
            </button>
          </div>

          <!-- Stack of Context Anchors (Scrollable) -->
          <div class="brain-content" id="brain-anchors-list">
            <!-- Empty State -->
            <div class="brain-empty-state" id="brain-empty-state">
              <p>Add context to help the AI understand<br>your project.</p>
            </div>
            <!-- Anchors will be injected here -->
          </div>

          <!-- Fixed Bottom Input Area -->
          <div class="brain-input-area">
            <div class="brain-input-container">
              <!-- Attachment Preview (Dynamic) -->
              <div class="brain-attachment-preview" id="brain-attachment-preview" style="display: none;">
                <div class="attachment-chip">
                  <span class="material-symbols-outlined" id="attachment-icon">description</span>
                  <span class="attachment-name" id="attachment-name">file.txt</span>
                  <button class="btn-icon-small" id="remove-attachment-btn">
                    <span class="material-symbols-outlined">close</span>
                  </button>
                </div>
              </div>

              <div class="brain-input-controls">
                <button class="btn-icon brain-attach-btn" id="brain-attach-btn" aria-label="Attach file">
                  <span class="material-symbols-outlined">attach_file</span>
                </button>
                <textarea class="brain-textarea" id="brain-input-text" placeholder="Add context" rows="1"></textarea>
                <button class="btn-icon-primary brain-send-btn" id="brain-send-btn" aria-label="Send">
                  <span class="material-symbols-outlined">arrow_upward</span>
                </button>
              </div>
            </div>

            <!-- Hidden File Input -->
            <input type="file" id="context-file-input"
              accept=".txt,.md,.png,.jpg,.jpeg,.webp,image/*,text/plain,text/markdown" class="visually-hidden">
          </div>
        </div>

        <div class="container">
          <div class="editor-wrapper">
            <!-- Editable layer with inline predictions -->
            <div class="editor" contenteditable="true" data-placeholder="What's on your mind" spellcheck="false"></div>
          </div>
        </div>

        <!-- Floating Editor Toolbar -->
        <div class="editor-toolbar">
          <button class="toolbar-btn clear-menu-btn" aria-label="Clear">
            <span class="material-symbols-outlined">ink_eraser</span>
          </button>
          <button class="toolbar-btn create-image-btn" aria-label="Create image">
            <span class="material-symbols-outlined">add_photo_alternate</span>
          </button>
          <button class="toolbar-btn toggle-prediction-btn" aria-label="Auto-prediction">
            <span class="material-symbols-outlined">auto_fix_high</span>
          </button>
          <button class="toolbar-btn copy-all-btn" aria-label="Copy all">
            <span class="material-symbols-outlined">content_copy</span>
          </button>
          <button class="toolbar-btn select-menu-btn" aria-label="Select part">
            <span class="material-symbols-outlined">text_select_end</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- About Modal -->
  <!-- About Modal -->
  <div class="modal" id="about-modal">
    <div class="modal-content context-modal-content">
      <!-- Modal Header -->
      <div class="context-modal-header">
        <div class="header-spacer"></div>
        <span class="context-modal-title">About</span>
        <div class="header-spacer"></div>
      </div>

      <!-- Modal Body -->
      <div class="context-modal-body">
        <div class="context-section">
          <div class="section-header">
            <h3 class="section-title">Mindcomplete</h3>
            <p class="section-description">
              Mindcomplete helps you expand your ideas by completing your thoughts with AI. Start typing, pause, and
              watch your ideas flow.
              <br><br>
              Click in the middle to accept part. Tab to accept full suggestion.
            </p>
          </div>

          <div class="modal-donate">
            <p class="section-description" style="margin-bottom: 16px;">Enjoying Mindcomplete?</p>
            <a href="https://buymeacoffee.com/yourusername" target="_blank" rel="noopener noreferrer"
              class="donate-btn">
              <span>‚òï</span> Buy me a coffee
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Files Modal (Desktop) -->
  <div class="modal" id="files-modal">
    <div class="modal-content files-modal-content">
      <div class="files-dropzone" id="files-dropzone">
        <div class="files-dropzone-icon">
          <span class="material-symbols-outlined">upload_file</span>
        </div>
        <div class="files-dropzone-title">Drop files here</div>
        <div class="files-dropzone-text">PDF, TXT, or Markdown files</div>
        <button class="btn-primary" id="browse-files-btn">Browse files</button>
      </div>
      <div class="files-list" id="files-list-section">
        <div class="files-list-header">
          <span class="files-list-title">Uploaded files</span>
          <span class="files-list-count" id="files-count">0 files</span>
        </div>
        <div id="files-list"></div>
      </div>
      <input type="file" id="file-input" multiple accept=".pdf,.txt,.md,text/plain,text/markdown,application/pdf"
        class="visually-hidden">
    </div>
  </div>

  <!-- Rules Modal (Desktop) -->
  <div class="modal" id="rules-modal">
    <div class="modal-content rules-modal-content">
      <div class="context-modal-header">
        <div class="header-spacer"></div>
        <span class="context-modal-title">Add rules</span>
        <div class="header-spacer"></div>
      </div>
      <div class="rules-modal-body">
        <p class="rules-description">Add rules to help the AI understand how to complete your thoughts.</p>
        <textarea class="rules-textarea" id="rules-textarea" placeholder="Write or paste your rules"></textarea>
        <div class="rules-buttons">
          <button class="btn-primary" id="save-rules-btn">Save rules</button>
          <button class="btn-secondary" id="clear-rules-btn">Clear rules</button>
          <span class="rules-status" id="rules-status"></span>
        </div>

        <div class="writing-style-modal-section"
          style="margin-top: 36px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px; display: flex; flex-direction: column; gap: 0;">
          <h3 class="side-menu-title" style="margin-bottom: 8px;">Writing Style</h3>
          <p class="rules-description" style="margin-bottom: 12px;">Choose how the AI should write for you.</p>

          <div class="custom-dropdown" id="style-dropdown">
            <button class="custom-dropdown-trigger">
              <span class="selected-value">No specific style</span>
              <span class="material-symbols-outlined">expand_more</span>
            </button>
            <div class="custom-dropdown-menu">
              <div class="custom-dropdown-item" data-value="none">No specific style</div>
              <div class="custom-dropdown-item" data-value="social">Social Media (short, concise)</div>
              <div class="custom-dropdown-item" data-value="story">Story (descriptive, narrative)</div>
              <div class="custom-dropdown-item" data-value="ideation">Ideation (expansive, creative)</div>
              <div class="custom-dropdown-item" data-value="custom">Custom style...</div>
            </div>
          </div>

          <textarea class="rules-textarea" id="custom-style-textarea"
            placeholder="Describe your custom writing style..." style="display: none;"></textarea>
          <div class="rules-buttons" style="margin-top: 12px;">
            <button class="btn-primary" id="save-style-btn">Save style</button>
            <button class="btn-secondary" id="clear-style-btn">Clear style</button>
            <span class="rules-status" id="style-status"></span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Files Bottom Sheet (Mobile) -->
  <div class="bottom-sheet-overlay" id="files-bottom-sheet">
    <div class="bottom-sheet files-bottom-sheet">
      <div class="files-sheet-handle">
        <div class="bottom-sheet-handle-bar"></div>
      </div>
      <div class="bottom-sheet-body">
        <div class="files-dropzone" id="files-dropzone-mobile">
          <div class="files-dropzone-icon">
            <span class="material-symbols-outlined">upload_file</span>
          </div>
          <div class="files-dropzone-title">Drop files here</div>
          <div class="files-dropzone-text">PDF, TXT, or Markdown</div>
          <button class="btn-primary" id="browse-files-btn-mobile">Browse files</button>
        </div>
        <div class="files-list" id="files-list-section-mobile">
          <div class="files-list-header">
            <span class="files-list-title">Files</span>
            <span class="files-list-count" id="files-count-mobile">0</span>
          </div>
          <div id="files-list-mobile"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Rules Bottom Sheet (Mobile) -->
  <div class="bottom-sheet-overlay" id="rules-bottom-sheet">
    <div class="bottom-sheet">
      <div class="bottom-sheet-handle">
        <div class="bottom-sheet-handle-bar"></div>
      </div>
      <div class="bottom-sheet-header">
        <span class="bottom-sheet-title">Add rules</span>
      </div>
      <div class="bottom-sheet-body">
        <div class="rules-modal-body">
          <p class="rules-description">Add rules to help the AI understand how to complete your thoughts.</p>
          <textarea class="rules-textarea" id="rules-textarea-mobile"
            placeholder="Write or paste your rules"></textarea>
          <div class="rules-buttons">
            <button class="btn-primary" id="save-rules-btn-mobile">Save</button>
            <button class="btn-secondary" id="clear-rules-btn-mobile">Clear</button>
          </div>

          <div class="writing-style-modal-section"
            style="margin-top: 36px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px; display: flex; flex-direction: column; gap: 0;">
            <h3 class="side-menu-title" style="margin-bottom: 8px;">Writing Style</h3>
            <p class="rules-description" style="margin-bottom: 12px;">Choose how the AI should write for you.</p>

            <div class="custom-dropdown" id="style-dropdown-mobile">
              <button class="custom-dropdown-trigger">
                <span class="selected-value">No specific style</span>
                <span class="material-symbols-outlined">expand_more</span>
              </button>
              <div class="custom-dropdown-menu">
                <div class="custom-dropdown-item" data-value="none">No specific style</div>
                <div class="custom-dropdown-item" data-value="social">Social Media (short, concise)</div>
                <div class="custom-dropdown-item" data-value="story">Story (descriptive, narrative)</div>
                <div class="custom-dropdown-item" data-value="ideation">Ideation (expansive, creative)</div>
                <div class="custom-dropdown-item" data-value="custom">Custom style...</div>
              </div>
            </div>

            <textarea class="rules-textarea" id="custom-style-textarea-mobile"
              placeholder="Describe your custom writing style..." style="display: none;"></textarea>
            <div class="rules-buttons" style="margin-top: 12px;">
              <button class="btn-primary" id="save-style-btn-mobile">Save style</button>
              <button class="btn-secondary" id="clear-style-btn-mobile">Clear</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Image Guidance Modal -->
  <div class="modal" id="image-guidance-modal">
    <div class="modal-content image-guidance-modal-content">
      <!-- Authorized View -->
      <div class="image-guidance-body" id="image-guidance-auth-view">
        <div class="image-guidance-field">
          <label for="image-style-select" class="section-description">Style</label>
          <select id="image-style-select" class="image-style-select">
            <option value="realistic" selected>Realistic</option>
            <option value="anime">Studio Ghibli</option>
            <option value="handdrawing">Handdrawing</option>
            <option value="custom1">Custom 1</option>
            <option value="custom2">Custom 2</option>
          </select>
        </div>
        <div class="image-guidance-field">
          <label for="image-guidance-textarea" class="section-description">Prompt</label>
          <textarea id="image-guidance-textarea" placeholder="Describe the image you want to create..."></textarea>
        </div>
        <div class="image-guidance-buttons">
          <button class="btn-secondary" id="skip-guidance-btn">Cancel</button>
          <button class="btn-primary" id="apply-guidance-btn">Create image</button>
        </div>
      </div>

      <!-- Unauthorized View -->
      <div class="image-guidance-body unauth-view" id="image-guidance-unauth-view" style="display: none;">
        <div class="image-guidance-promo">
          <span class="material-symbols-outlined"
            style="font-size: 48px; color: var(--accent); margin-bottom: 16px;">auto_awesome</span>
          <h3 class="side-menu-title">Premium Feature</h3>
          <p class="section-description" style="margin: 12px 0 24px;">
            Image generation is available for registered users.
            Join Mindcomplete to bring your thoughts to life.
          </p>
        </div>
        <div class="image-guidance-buttons" style="flex-direction: column; width: 100%;">
          <button class="btn-primary" id="image-unauth-signup-btn" style="width: 100%;">Join now</button>
          <button class="btn-secondary" id="image-unauth-signin-btn" style="width: 100%;">Sign in</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Valleys Modal -->
  <div class="modal" id="valleys-modal">
    <div class="modal-content context-modal-content">
      <div class="context-modal-header">
        <div class="header-spacer"></div>
        <span class="context-modal-title">Valleys</span>
        <div class="header-spacer"></div>
      </div>
      <div class="context-modal-body">
        <div class="context-section">
          <div class="section-header">
            <p class="section-description">Your saved valleys</p>
          </div>
          <div class="valleys-list" id="valleys-list"></div>
          <div class="valleys-empty" id="valleys-empty">
            <p class="section-description">No valleys saved yet</p>
          </div>
          <div class="section-buttons">
            <button class="btn-primary" id="new-valley-btn">
              <span class="material-symbols-outlined">add</span>
              New valley
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Auth Modal -->
  <div class="modal" id="auth-modal">
    <div class="modal-content context-modal-content">
      <div class="context-modal-header" style="justify-content: flex-end; padding: 0 4px 0 0;">
        <button class="context-modal-close" id="auth-modal-close" aria-label="Close">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
      <div class="context-modal-body" style="gap: 36px;">

        <!-- Title -->
        <h2 class="auth-modal-title" id="auth-modal-title" style="margin: 0;">Sign In</h2>

        <!-- Sign In Layout: Google first -->
        <div id="auth-signin-layout">
          <button class="btn-google" id="auth-google-btn">
            <svg class="google-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="20px" height="20px">
              <path fill="#FFC107"
                d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z" />
              <path fill="#FF3D00"
                d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z" />
              <path fill="#4CAF50"
                d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z" />
              <path fill="#1976D2"
                d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z" />
            </svg>
            <span id="auth-google-text">Sign in with Google</span>
          </button>

          <div class="auth-divider" style="margin: 36px 0;">
            <span class="auth-divider-text">or</span>
          </div>

          <div class="auth-form" id="auth-form-section" style="margin-bottom: 36px;">
            <input type="email" id="auth-email" class="auth-input" placeholder="Email">
            <input type="password" id="auth-password" class="auth-input" placeholder="Password">
            <div class="auth-error" id="auth-error"></div>
          </div>

          <button class="btn-primary" id="auth-submit-btn" style="width: 100%;">Sign In</button>
        </div>

        <!-- Create Account Layout: Email first (hidden by default) -->
        <div id="auth-signup-layout" style="display: none;">
          <div class="auth-form" style="margin-bottom: 36px;">
            <input type="email" id="auth-email-signup" class="auth-input" placeholder="Email">
            <input type="password" id="auth-password-signup" class="auth-input" placeholder="Password">
            <div class="auth-error" id="auth-error-signup"></div>
          </div>

          <button class="btn-primary" id="auth-submit-btn-signup" style="width: 100%; margin-bottom: 36px;">Create
            Account</button>

          <div class="auth-divider" style="margin: 0;">
            <span class="auth-divider-text">or</span>
          </div>

          <button class="btn-google" id="auth-google-btn-signup" style="margin-top: 36px;">
            <svg class="google-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="20px" height="20px">
              <path fill="#FFC107"
                d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z" />
              <path fill="#FF3D00"
                d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z" />
              <path fill="#4CAF50"
                d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z" />
              <path fill="#1976D2"
                d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z" />
            </svg>
            <span>Sign up with Google</span>
          </button>
        </div>

        <!-- Footer -->
        <div class="auth-footer" style="margin: 0;">
          <p id="auth-toggle-text">Don't have an account? <a href="#" id="auth-toggle-mode">Create one</a></p>
        </div>

      </div>
    </div>
  </div>

  <!-- Edit Name Modal -->
  <div class="modal" id="edit-name-modal">
    <div class="modal-content context-modal-content" style="max-width: 400px; min-width: auto;">
      <div class="context-modal-header" style="justify-content: flex-end; padding: 0 4px 0 0;">
        <button class="context-modal-close" id="edit-name-close" aria-label="Close">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
      <div class="context-modal-body" style="gap: 24px;">
        <h2 class="auth-modal-title" style="margin: 0;">Rename Project</h2>
        <input type="text" id="edit-name-input" class="auth-input" placeholder="Project name">
        <button class="btn-primary" id="edit-name-save" style="width: 100%">Save</button>
      </div>
    </div>
  </div>

  <!-- Account / Settings Modal -->
  <div class="modal settings-modal" id="account-modal">
    <div class="settings-panel">
      <div class="settings-panel-header">
        <div>
          <h3>Settings</h3>
          <p>Manage your account and workspace</p>
        </div>
      </div>
      <div class="settings-panel-body">
        <nav class="settings-nav" id="settings-nav">
          <button class="settings-nav-btn active" data-settings-panel="general">
            <span class="material-symbols-outlined">settings</span>
            <span>General</span>
          </button>
          <button class="settings-nav-btn" data-settings-panel="notifications">
            <span class="material-symbols-outlined">notifications</span>
            <span>Notifications</span>
          </button>
          <button class="settings-nav-btn" data-settings-panel="appearance">
            <span class="material-symbols-outlined">palette</span>
            <span>Appearance</span>
          </button>
          <button class="settings-nav-btn" data-settings-panel="security">
            <span class="material-symbols-outlined">shield_lock</span>
            <span>Security</span>
          </button>
          <button class="settings-nav-btn" data-settings-panel="billing">
            <span class="material-symbols-outlined">credit_card</span>
            <span>Billing</span>
          </button>
          <button class="settings-nav-btn" data-settings-panel="account">
            <span class="material-symbols-outlined">account_circle</span>
            <span>Account</span>
          </button>
        </nav>
        <div class="settings-content" id="settings-content">
          <section class="settings-section active" data-settings-panel="general">
            <h4>General</h4>
            <div class="settings-row">
              <div>
                <p>Appearance</p>
                <small>Switch between light and dark themes.</small>
              </div>
              <div class="settings-control">
                <button class="btn-secondary theme-toggle-btn">Toggle theme</button>
              </div>
            </div>
            <div class="settings-row">
              <div>
                <p>Accent color</p>
                <small>Choose a highlight to personalize the editor.</small>
              </div>
              <div class="settings-control">
                <select id="accent-select">
                  <option value="purple" selected>Purple</option>
                  <option value="blue">Blue</option>
                  <option value="green">Green</option>
                </select>
              </div>
            </div>
          </section>
          <section class="settings-section" data-settings-panel="notifications">
            <h4>Notifications</h4>
            <p class="section-description">Notifications are coming soon.</p>
          </section>
          <section class="settings-section" data-settings-panel="appearance">
            <h4>Appearance</h4>
            <p class="section-description">Adjust typography and layout preferences to fine-tune your writing space.</p>
          </section>
          <section class="settings-section" data-settings-panel="security">
            <h4>Security</h4>
            <p class="section-description">Use a secure password and enable two-factor authentication.</p>
          </section>
          <section class="settings-section" data-settings-panel="billing">
            <h4>Billing & Subscription</h4>
            <div class="subscription-card" id="subscription-card">
              <div class="subscription-header">
                <div>
                  <h5 id="subscription-tier">Free Plan</h5>
                  <p class="subscription-price" id="subscription-price">$0/month</p>
                </div>
                <span class="subscription-badge" id="subscription-badge">Free</span>
              </div>
              <div class="subscription-features">
                <div class="feature-row">
                  <span>Text Predictions</span>
                  <strong id="feature-predictions">Unlimited</strong>
                </div>
                <div class="feature-row">
                  <span>Image Generations</span>
                  <strong id="feature-images">0/month</strong>
                </div>
                <div class="feature-row">
                  <span>Saved Valleys</span>
                  <strong id="feature-valleys">0</strong>
                </div>
                <div class="feature-row">
                  <span>Image Credits</span>
                  <strong id="feature-credits">0</strong>
                </div>
              </div>
            </div>
            <div class="settings-row" id="upgrade-row">
              <div>
                <p>Upgrade to Pro</p>
                <small>Unlock unlimited text, 30 images/month, and save up to 20 valleys for $5.99/month</small>
              </div>
              <div class="settings-control">
                <button class="btn-primary" id="upgrade-btn">Upgrade to Pro</button>
              </div>
            </div>
            <div class="settings-row" id="credits-row">
              <div>
                <p>Buy Image Credits</p>
                <small>Need more images? Get 50 credits for $2.99</small>
              </div>
              <div class="settings-control">
                <button class="btn-secondary" id="buy-credits-btn">Buy Credits</button>
              </div>
            </div>
          </section>
          <section class="settings-section" data-settings-panel="account">
            <h4>Account</h4>
            <div class="settings-row">
              <div>
                <p>Email</p>
                <small id="account-email">Sign in to see your email</small>
              </div>
              <div class="settings-control">
                <button class="btn-primary" id="signout-btn">Sign Out</button>
              </div>
            </div>
            <div class="settings-row">
              <div>
                <p>Danger zone</p>
                <small>Permanently remove your account and valleys.</small>
              </div>
              <div class="settings-control">
                <button class="btn-danger" id="delete-account-btn">Delete account</button>
              </div>
            </div>
          </section>
        </div>
      </div>
    </div>
  </div>

  <!-- User Menu (Left Sidebar) -->
  <div class="menu-overlay user-menu-overlay">
    <div class="menu-content user-menu-content">
      <!-- User Profile Header (Click to edit) -->
      <button class="menu-item" id="user-menu-header">
        <span class="material-symbols-outlined">account_circle</span>
        <span class="menu-label">Account</span>
      </button>
      <button class="menu-item" id="user-settings-btn">
        <span class="material-symbols-outlined">settings</span>
        <span class="menu-label">Settings</span>
      </button>
      <button class="menu-item about-menu-btn">
        <span class="material-symbols-outlined">info</span>
        <span class="menu-label">About</span>
      </button>
      <button class="menu-item theme-toggle-btn">
        <span class="material-symbols-outlined">dark_mode</span>
        <span class="menu-label">Dark mode</span>
      </button>
      <button class="menu-item" id="user-logout-btn">
        <span class="material-symbols-outlined">logout</span>
        <span class="menu-label">Log out</span>
      </button>
    </div>
  </div>

  <!-- Valley Context Menu -->
  <div class="menu-overlay valley-menu-overlay" id="valley-context-menu">
    <div class="menu-content" style="min-width: 160px;">
      <button class="menu-item rename-valley-btn">
        <span class="material-symbols-outlined">edit</span>
        <span class="menu-label">Rename</span>
      </button>
      <button class="menu-item share-valley-btn">
        <span class="material-symbols-outlined">share</span>
        <span class="menu-label">Share</span>
      </button>
      <button class="menu-item delete-valley-btn" style="color: rgb(231, 76, 60);">
        <span class="material-symbols-outlined">delete</span>
        <span class="menu-label">Delete</span>
      </button>
    </div>
  </div>

  <script type="module" src="supabaseClient.js"></script>
  <script src="app.js?v=token-update-2"></script>
</body>

</html>